#jinja2: lstrip_blocks: "True", trim_blocks: "True"
{{ ansible_managed | comment }}
{% set setmerged = nft_conntrack_default.copy() %}
{% set _ = setmerged.update(nft_conntrack) %}
{% set _ = setmerged.update(nft_conntrack_group) %}
{% if nft_merged_groups and hostvars[inventory_hostname]['nft_combined_rules'].nft_conntrack_group is defined %}
  {% set _ = setmerged.update(hostvars[inventory_hostname]['nft_combined_rules'].nft_conntrack_group) %}
{% endif %}
{% set _ = setmerged.update(nft_conntrack_host) %}

{% for set, rules in setmerged|dictsort  %}
  {% if rules %}
ct helper {{ set }} {
    {% for rule in rules %}
	type "{{ rule.type }}" protocol {{ rule.protocol }};
    {% endfor %}
}
  {% endif %}

{% endfor %}
